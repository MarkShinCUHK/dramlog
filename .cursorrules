# DramLog 개발 규칙

## 프로젝트 개요
- **프로젝트**: DramLog - 위스키 리뷰/게시글 커뮤니티 웹사이트
- **기술 스택**: SvelteKit + Tailwind CSS + Supabase
- **렌더링**: 서버사이드 렌더링(SSR) 기반
- **개발 모드**: 1인 개발 기준

## 핵심 원칙
- **Tailwind CSS만 사용**: 일반 CSS 작성 최소화, Tailwind 유틸리티 클래스 적극 활용
- **컴포넌트 분리**: 작은 단위로 컴포넌트 분리, 재사용성 고려
- **SvelteKit 규칙 준수**: `+page.svelte`, `+layout.svelte`, `+page.server.ts` 등 파일 기반 라우팅 규칙 준수
- **Supabase 사용**: 데이터베이스는 Supabase 사용 (PostgreSQL16 기반)
- **서버 전용 클라이언트**: `src/lib/server/supabase/client.ts`에서만 Supabase 클라이언트 생성
- **보안**: Service Role Key 절대 사용 금지, 클라이언트 노출 금지

## 코딩 스타일
- 들여쓰기: 2 spaces
- 변수명: camelCase
- 컴포넌트명: PascalCase
- 주석: 한국어로 작성
- Tailwind 클래스: 의미있는 그룹핑, 가독성 고려

## 파일 구조 (SvelteKit)
```
src/
├── routes/
│   ├── +layout.svelte (공통 레이아웃)
│   ├── +page.svelte (메인 페이지)
│   ├── posts/
│   │   ├── +page.svelte (게시글 리스트)
│   │   └── [id]/
│   │       └── +page.svelte (게시글 상세)
│   └── write/
│       └── +page.svelte (글 작성)
├── lib/
│   ├── components/ (재사용 컴포넌트)
│   │   ├── Header.svelte
│   │   ├── Footer.svelte
│   │   └── PostCard.svelte
│   └── server/ (서버 전용 코드)
│       └── supabase/
│           ├── client.ts (Supabase 클라이언트 생성)
│           ├── types.ts (타입 정의)
│           └── queries/
│               └── posts.ts (게시글 쿼리 함수)
└── app.html
```

## MVP 기능 (현재 단계 - 완료 ✅)
1. ✅ 메인 페이지: 커뮤니티 소개 + 최신 글 목록
2. ✅ 게시글 리스트 페이지
3. ✅ 게시글 상세 페이지
4. ✅ 글 작성 페이지 (Supabase 저장)
5. ✅ 공통 레이아웃 (헤더/푸터)
6. ✅ PostgreSQL 16 설치 및 데이터베이스 생성 완료 (레거시)
7. ✅ PostgreSQL 연결 및 마이그레이션 구현 (레거시)
8. ✅ 데이터베이스 스키마 생성 (posts 테이블)
9. ✅ 게시글 CRUD 기능 (생성, 조회, 목록)
10. ✅ 프로젝트 이름 DramLog로 통일
11. ✅ 날짜 2026-01-20 기준으로 업데이트
12. ✅ Supabase 통합 (글 작성/목록/상세 - 완전 전환 완료)
13. ✅ 게시글 수정 기능 (`/posts/[id]/edit`)
14. ✅ 게시글 삭제 기능 (상세 페이지)

## 다음 단계 (우선순위 순)

### MVP 3단계: 게시글 관리 기능 (완료 ✅)
1. ✅ **게시글 수정 기능**
   - `/posts/[id]/edit` 라우트 생성 완료
   - 수정 폼 페이지 (`+page.svelte`) 구현 완료
   - 서버 액션으로 업데이트 (`updatePost` 함수) 구현 완료
   - 현재는 모든 사용자 수정 가능 (인증 전 단계)

2. ✅ **게시글 삭제 기능**
   - 게시글 상세 페이지에 삭제 버튼 추가 완료
   - 서버 액션으로 삭제 (`deletePost` 함수) 구현 완료
   - 삭제 확인 다이얼로그 (confirm) 구현 완료
   - 현재는 모든 사용자 삭제 가능 (인증 전 단계)

3. ✅ **쿼리 함수 추가**
   - `src/lib/server/supabase/queries/posts.ts`에 `updatePost`, `deletePost` 함수 구현 완료

### MVP 4단계: 인증 시스템
1. **인증 방식 선택**
   - 옵션 1: Auth.js (SvelteKit 공식 인증 라이브러리)
   - 옵션 2: 직접 구현 (세션 기반)
   - 옵션 3: Supabase Auth (필요시)

2. **인증 기능**
   - 회원가입/로그인 페이지
   - 세션 관리
   - 사용자 테이블 생성 (`users` 테이블)
   - 게시글 작성자와 사용자 연결

3. **권한 관리**
   - 본인 게시글만 수정/삭제 가능
   - 로그인한 사용자만 글 작성 가능

### MVP 5단계: 핵심 기능 강화
1. **검색 기능**
   - 게시글 제목/내용 검색
   - 검색 결과 페이지
   - DB 쿼리 최적화 (인덱스 추가 고려)

2. **댓글 시스템**
   - `comments` 테이블 생성
   - 게시글 상세 페이지에 댓글 섹션
   - 댓글 작성/수정/삭제 기능

3. **좋아요 기능**
   - `likes` 테이블 생성 또는 posts 테이블의 likes 컬럼 활용
   - 좋아요 버튼 및 카운트 표시

### MVP 6단계: UI/UX 개선
1. **반응형 디자인**
   - 모바일 최적화
   - 태블릿 레이아웃
   - 데스크톱 레이아웃

2. **사용자 경험 개선**
   - 로딩 상태 표시
   - 에러 메시지 개선
   - 성공 피드백 (토스트 메시지 등)
   - 페이지네이션 (게시글 목록)

3. **성능 최적화**
   - 이미지 lazy loading (이미지 업로드 기능 추가 시)
   - 코드 스플리팅
   - DB 쿼리 최적화

### 향후 추가 예정
- 이미지 업로드 (로컬 스토리지 또는 클라우드 스토리지)
- 사용자 프로필 페이지
- 북마크 기능
- 태그 시스템
- 위스키 정보 데이터베이스 (위스키 종류, 브랜드 등)

## 디자인 가이드
- **색감**: 위스키 커뮤니티 느낌의 따뜻한 톤 (골드, 앰버, 다크 브라운 계열)
- **반응형**: Mobile First 접근
- **UI**: 모던하고 깔끔한 디자인, Tailwind 기본 스타일 활용

## 금지 사항
- 일반 CSS 파일 작성 (Tailwind로 해결 불가능한 경우만 예외)
- 인증 시스템 (현재 단계)
- 복잡한 상태 관리 (필요시만 간단한 store 사용)
- **Supabase Service Role Key 사용 금지**: 클라이언트에 노출되면 안 됨
- **Supabase 클라이언트를 클라이언트 사이드에서 직접 생성 금지**: `src/lib/server/supabase/client.ts`에서만 생성
- **DB 접근은 쿼리 계층을 통해서만**: `src/lib/server/supabase/queries/posts.ts`의 함수들을 사용

## 개발 프로세스 규칙
1. **구현**: 기능 개발
2. **테스트**: 구현 완료 후 반드시 테스트 수행
3. **문서 업데이트**: 테스트 완료 후 `.cursorrules`와 `web-dev-guidelines.md` 업데이트
   - 완료된 기능은 ✅ 표시
   - 진행 중인 작업은 🔄 표시
   - 예정된 작업은 명확히 구분

## Supabase 관련 규칙
- **환경 변수**: `PUBLIC_SUPABASE_URL`, `PUBLIC_SUPABASE_ANON_KEY` 사용
- **RLS (Row Level Security)**: MVP 단계에서는 비활성화하여 insert 가능하도록 설정
- **서버 전용**: `src/lib/server/supabase/client.ts`에서만 클라이언트 생성
- **쿼리 계층**: `src/lib/server/supabase/queries/posts.ts`가 DB 접근의 단일 창구
- **보안**: ANON_KEY는 RLS로 제어되므로 안전하지만, Service Role Key는 절대 사용하지 않음

## 추가 참조
- 상세 가이드라인: `web-dev-guidelines.md` 참조
- 마지막 업데이트: 2026-01-20 (MVP 3: 게시글 수정/삭제 완료)